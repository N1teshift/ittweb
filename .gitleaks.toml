# Gitleaks configuration for ITT Web
# Scans for accidentally committed secrets

title = "ITT Web Secrets Detection"

[extend]
# Use default rules
useDefault = true

# Additional custom rules
[[rules]]
id = "ittweb-firebase-service-account"
description = "Firebase Service Account Key"
regex = '''"type"\s*:\s*"service_account"'''
tags = ["firebase", "service-account", "credentials"]

[[rules]]
id = "ittweb-nextauth-secret"
description = "NextAuth Secret Key"
regex = '''NEXTAUTH_SECRET\s*=\s*['"][^'"]{32,}['"]'''
tags = ["nextauth", "secret", "auth"]

[[rules]]
id = "ittweb-discord-secret"
description = "Discord Client Secret"
regex = '''DISCORD_CLIENT_SECRET\s*=\s*['"][^'"]{32,}['"]'''
tags = ["discord", "oauth", "secret"]

# Allowlist patterns (files that may contain false positives)
[allowlist]
description = "Allowlist for known safe files"

# Ignore test files and mocks
[[allowlist.paths]]
regex = '''\.env\.example'''
reason = "Example environment file"

[[allowlist.paths]]
regex = '''\.env\.local\.example'''
reason = "Example local environment file"

[[allowlist.paths]]
regex = '''docs/.*'''
reason = "Documentation files"

[[allowlist.paths]]
regex = '''\.workflow/.*'''
reason = "Workflow documentation"

[[allowlist.paths]]
regex = '''\.github/workflows/.*'''
reason = "GitHub workflow files"

[[allowlist.paths]]
regex = '''\.gitleaks\.toml'''
reason = "Gitleaks configuration file"

[[allowlist.paths]]
regex = '''README\.md'''
reason = "README file"

[[allowlist.paths]]
regex = '''\.gitignore'''
reason = "Git ignore file"

[[allowlist.paths]]
regex = '''__tests__/.*'''
reason = "Test files may contain example secrets"

[[allowlist.paths]]
regex = '''__mocks__/.*'''
reason = "Mock files may contain example secrets"

[[allowlist.paths]]
regex = '''\.test\.(ts|tsx|js|jsx)$'''
reason = "Test files may contain example secrets"

[[allowlist.paths]]
regex = '''\.spec\.(ts|tsx|js|jsx)$'''
reason = "Test files may contain example secrets"

