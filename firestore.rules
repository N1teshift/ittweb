rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Archives collection - public read/write for now
    match /archives/{document} {
      allow read, write: if true;
    }

    // UserData collection - public read/write for now
    // Note: You can tighten these rules later to require authentication
    match /userData/{discordId} {
      allow read, write: if true;
    }

    // Posts collection - public read, authenticated write
    match /posts/{postId} {
      allow read: if true;
      allow write: if request.auth != null;
    }

    // Scheduled Games collection - public read, authenticated write
    // Note: Admin SDK bypasses these rules for API routes, but they're here for client-side operations
    match /scheduledGames/{gameId} {
      allow read: if true;
      allow write: if request.auth != null;
    }

    // Games collection - public read, authenticated write
    match /games/{gameId} {
      allow read: if true;
      allow write: if request.auth != null;
      
      // Game players subcollection
      match /players/{playerId} {
        allow read: if true;
        allow write: if request.auth != null;
      }
    }

    // Player Stats collection - public read, server-side write only
    match /playerStats/{playerName} {
      allow read: if true;
      allow write: if false; // Only updated by server-side functions
    }

    // ELO History collection - public read, server-side write only
    match /eloHistory/{historyId} {
      allow read: if true;
      allow write: if false; // Only updated by server-side functions
    }

    // Class Stats collection - public read, server-side write only
    match /classStats/{classId} {
      allow read: if true;
      allow write: if false; // Only updated by server-side functions
    }
  }
}


